{
    "$id": "https://example.com/dpop_boud_access_token.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "The paylod of an access token bounded to public key of a DPoP JWT",
    "type": "string",
    "contentMediaType": "application/jwt",
    "contentSchema": 
    {
        "type": "array",
        "minItems": 2,
        "prefixItems":[
        {
            "const": {
                "typ": "dpop+jwt",
                "alg": "ES256",
                "kid": "$public-key-id-of-the-private-key-used-by-the-Token-Endpoint-of-the-PID/EAA-Provider-to-sign-the-jwt$" 
            }
        },
        {
            "type": "object",
            "required": ["jti", "iss", "sub", "aud", "iat", "exp", "jkt"],
            "properties": {
                "jti": {
                    "type": "string",
                    "description": "Unique identifier; can be used to prevent the JWT from being replayed (allows a token to be used only once)",
                    "format": "UUID",
                    "example": "f352c2fa-2d06-47b9-8347-8cda8a70a17d"
                },
                "iss": {
                    "type": "string",
                    "description": "The Issuer of the JWT; it MUST be set to the URI of the Token Endpoint of the Authorization Server",
                    "example": "https://it-wallet-provider.example.it/token"
                },
                "sub": {
                    "type": "string",
                    "description": "The Subject of the JWT; it MUST be set with a no persistent identifier assigned to the authenticated end-user by the Token Endpoint of the Authorization Server",
                    "example": "NzbLsXh8uDCcd7noWXFZAfHkxZsRGC9Xs"
                },
                "aud": {
                    "type": "string",
                    "description": "An URI value that identifies the recipient that the JWT is intended for; it MUST be set to the URI of the Credential Endpoint of the Credential Issuer",
                    "example": "https://it-wallet-provider.example.it/credential"
                },
                "iat": {
                    "type": "number",
                    "description": "The UNIX Timestamp at which the JWT was issued; can be used to determine age of the JWT",
                    "example": "1710346343"
                },
                "exp": {
                    "type": "number",
                    "description": "The UNIX Timestamp after which the JWT expire",
                    "example": "1701960844"
                },
                "nbf": {
                    "type": "number",
                    "description": "The UNIX Timestamp before which the JWT must not be accepted for processing",
                    "example": "1710346343"
                },
                "jkt": {
                    "type": "string",
                    "description": "The base64url encoding SHA-256 thumprint of the DPoP public key (in JWK format) to which the Access Token is bound",
                    "example": "kQMU13Nrvic2D9IGp2t-PhLfiHGEFG5ROEIIeyue7NM"
                }
            }
        }
        ]
    }
}