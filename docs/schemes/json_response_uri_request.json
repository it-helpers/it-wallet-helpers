{
    "$id": "https://example.com/credential_pop.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "Response URI Request",
    "type": "Json",
    "required": [
        "vp_token",
        "presentation_submission",
        "state"
    ],
    "properties": {
        "vp_token": {
            "type": "array",
            "description": "JSON Array containing the Verifiable Presentation(s). There MUST be at least two signed presentations in this Array: - The requested Digital Credential (one or more, in format of SD-JWT VC or MDOC CBOR) - The Wallet Attestation",
            "example": ["ewogICAidHlwIjoidmMrc2Qtand0IiwKICAgImFsZyI6IkVTMjU2IiwKICAgImtpZCI6ImVOTi1nNWk2Q25MS2NsdFFCcDZhYmJpb0dNYnpNNm11VzN2dXh3NnVoODgiCn0.ewogICJfc2QiOiBbCiAgICAiTk94VnpqVUpnNjY3aUJkZUR3bXI2dFo0NlgtamNoS3dJVnhNQWZ2NDN5YyIsCiAgICAid3lmeFZxcTlCb3NQVDd0TjRTSE9JNEU0OFAxOWFWQTFrdFc1WmYwRS1mYyIsCiAgICAiVUhDaHBHdE5GMmJqMUZ2QWZCYnkxcm5mN1dYa3hlbEZKNWE0dlNqMkZPNCIsCiAgICAiVEsyUmd1UFlvWHpDeDB2djVoYk45dTVNMm1IbFdCdDQxcUdXbExYQ051OCIsCiAgICAiV0lpbFRIZ1hrcnl2TzRIZEpBVGRxb1lLM0o4V1NRQUl1akd4ZTFmYjhiRSIKICBdLAogICJleHAiOiAxODgzMDAwMDAwLAogICJpc3MiOiAiaHR0cHM6Ly9waWRwcm92aWRlci5leGFtcGxlLm9yZyIsCiAgInN1YiI6ICJOemJMc1hoOHVEQ2NkN25vV1hGWkFmSGt4WnNSR0M5WHMiLAogICJzdGF0dXMiOiB7CiAgICAic3RhdHVzX2F0dGVzdGF0aW9uIjogewogICAgICAiY3JlZGVudGlhbF9oYXNoX2FsZyI6ICJzaGEtMjU2IgogICAgfQogIH0sCiAgInZjdCI6ICJQZXJzb25JZGVudGlmaWNhdGlvbkRhdGEiLAogICJfc2RfYWxnIjogInNoYS0yNTYiLAogICJjbmYiOiB7CiAgICAiandrIjogewogICAgICAia3R5IjogIkVDIiwKICAgICAgImNydiI6ICJQLTI1NiIsCiAgICAgICJ4IjogIlRDQUVSMTladnUzT0hGNGo0VzR2ZlNWb0hJUDFJTGlsRGxzN3ZDZUdlbWMiLAogICAgICAieSI6ICJaeGppV1diWk1RR0hWV0tWUTRoYlNJaXJzVmZ1ZWNDRTZ0NGpUOUYySFpRIgogICAgfQogIH0KfQ.MrbtZznuS3fnYugwMTFRi0AMTS5rKlLvqwbRRZWeqkA8EpSnEHtTUhA4bR-QF0sInThLeLFS5C4pVf414gy1UT-IS2vx0xksnXaUnMqIaPOF8ElRPTwUYI8tXeV8LM_wsmV61TtZadHOn6YHpju-jHEtMcD80ddwzJhSq4jig-lBVH_Ud-KWIKtN60SJ1uHxFar1Jdhoi6AlHI5u3nIzbmKG6a87qN00rqtcL2LE11IhDh3yg8XqbszqEaRftLtPl833_YD5t4tO0xiU25zq_TAWt5L_5ea7JjY6k-zzo-X2GEedRDRFSfmG6Nbk4ZvZ16ildG-pjiXLS6bpPQ1nvg~WyJrdWNyQm1sb19oTWFJRkY1ODVSemFRIiwgInVuaXF1ZV9pZCIsICJ4eHh4eHh4eC14eHh4LXh4eHgteHh4eC14eHh4eHh4eHh4eHgiXQ~WyJOVE5Sb09pdVZWUnRGNkNFenRkOVp3IiwgImdpdmVuX25hbWUiLCAiTWFyaW8iXQ~WyJGRFNTUGdnekdCVXdRTEhEU0U2d1FRIiwgImZhbWlseV9uYW1lIiwgIlJvc3NpIl0~WyJLWjhlNXdWRXREdmIxemlTUEE0RHpBIiwgImJpcnRoX2RhdGUiLCAiMTk4MC0wMS0xMCJd~WyJwWjVNUnlPeHBWV1p1SExvSi15alJnIiwidGF4X2lkX2NvZGUiLCJSU1NNUkE4MFIwMUg1MDFCIl0","ewogICJhbGciOiAiRVMyNTYiLAogICJ0eXAiOiAiSldUIiwKICAia2lkIjogImVOTi1nNWk2Q25MS2NsdFFCcDZhYmJpb0dNYnpNNm11VzN2dXh3NnVoODgiLAp9.ewogICJzY29wZSI6ICJJVCBXYWxsZXQiLAogICJjbGllbnRfaWRfc2NoZW1lIjogInZwX3Rva2VuIiwKICAiY2xpZW50X2lkIjogIkF4akFuajB0NXFwUlZnUjZhcFo3Z0NoYVBiNnk4Z05tN0NrUGQ1OFBENGMiLAogICJyZXNwb25zZV9tb2RlIjogImRpcmVjdF9wb3N0Lmp3dCIsCiAgInJlc3BvbnNlX3R5cGUiOiAiY29kZSIsCiAgInJlc3BvbnNlX3VyaSI6ICJodHRwczovL3dhbGxldC1ycC5pcHpzLml0L2NhbGxiYWNrIiwKICAibm9uY2UiOiAidHNfRXRVUXMwaWVpSVMxTllOQkhFUVNveTNjdDRncHktNEZaS3dIaWxrWSIsIAogICJzdGF0ZSI6ICJmeVppT0w5TGYyQ2VLdU5UMkp6eGlMUkRpbmswdVBjZCIsCiAgImlzcyI6ICJodHRwczovL3dhbGxldC1ycC5pcHpzLml0IiwKICAiaWF0IjogMTY3MjQxODQ2NSwKICAiZXhwIjogMTY3MjQyMjA2NSwKICAicmVxdWVzdF91cmlfbWV0aG9kIjogImdldCIKfQ.MrbtZznuS3fnYugwMTFRi0AMTS5rKlLvqwbRRZWeqkA8EpSnEHtTUhA4bR-QF0sInThLeLFS5C4pVf414gy1UT-IS2vx0xksnXaUnMqIaPOF8ElRPTwUYI8tXeV8LM_wsmV61TtZadHOn6YHpju-jHEtMcD80ddwzJhSq4jig-lBVH_Ud-KWIKtN60SJ1uHxFar1Jdhoi6AlHI5u3nIzbmKG6a87qN00rqtcL2LE11IhDh3yg8XqbszqEaRftLtPl833_YD5t4tO0xiU25zq_TAWt5L_5ea7JjY6k-zzo-X2GEedRDRFSfmG6Nbk4ZvZ16ildG-pjiXLS6bpPQ1nvg"]
        },
        "presentation_submission": {
            "type": "json",
            "description": "JSON Object containing the mappings between the requested Verifiable Credentials and where to find them within the returned Verifiable Presentation Token",
            "example": "{\"definition_id\": \"32f54163-7166-48f1-93d8-ff217bdb0653\",\"id\": \"04a98be3-7fb0-4cf5-af9a-31579c8b0e7d\",\"descriptor_map\": [{\"id\": \"IT Wallet","path": "$.vp_token.verified_claims.claims._sd[0]\",\"format\": \"vc+sd-jwt\"},{\"id\": \"WalletAttestation\",\"path\": \"$\",\"format\": \"jwt\"}]}"
        },
        "state": {
            "type": "string",
            "description": "Unique identifier provided by the Relying Party within the Authorization Request",
            "example": "3be39b69-6ac1-41aa-921b-3e6c07ddcb03"
        }
    }
}