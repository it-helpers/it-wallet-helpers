{
    "$id": "https://example.com/jwt_openid4vci_proof.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "openid4vci proof",
    "type": "string",
    "contentMediaType": "application/jwt",
    "contentSchema": 
    {
        "type": "array",
        "minItems": 2,
        "prefixItems":[
        {
            "const": {
                "typ": "openid4vci-proof+jwt",
                "alg": "ES256",
                "jwk": "{\"kty\":\"EC\",\"x\":\"35lvC8uz2QrWpQJ3TUH8t9o9DURMp7ydU518RKDl20k\",\"y\":\"I8BuXB2bvxelzJAd7OKhd-ZwjCst05Fx47Mb_0ugros\",\"crv\":\"P-256\"}" 
            }
        },
        {
            "type": "object",
            "required": ["iat", "aud", "htu", "htm", "ath"],
            "properties": {
                "iss": {
                    "type": "string",
                    "description": "The Issuer of the JWT; it MUST be set to the client_id of the Wallet Instance",
                    "example": "https://it-wallet-eid-provider.example.it/token"
                },
                "iat": {
                    "type": "number",
                    "description": "The UNIX Timestamp at which the JWT was issued; can be used to determine age of the JWT",
                    "example": "1710346343"
                },
                "aud": {
                    "type": "string",
                    "description": "An URI value that identifies the recipient that the JWT is intended for; it MUST be set to the URI of the Credential Endpoint of the PID/EAA Provider",
                    "example": "https://it-wallet-eid-provider.example.it/credential"
                },
                "nonce": {
                    "type": "string",
                    "description": "It MUST be set to the same value of the 'c_nonce' parameter in the Token Request provided by the Token Endpoint of the PID/EAA Issuer",
                    "example": "ts_EtUQs0ieiIS1NYNBHEQSoy3ct4gpy-4FZKwHilkY"
                }
            }
        }
        ]
    }
}