{
    "$id": "https://example.com/vc_sd.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "vc_sd",
    "type": "object",
    "required": [
        "iss",
        "sub",
        "iat",
        "exp",
        "nbf",
        "vct",
        "_sd_alg",
        "_sd",
        "cnf"
    ],
    "properties": {
        "iss": {
            "type": "string",
            "description": "The Issuer of the Verifiable Credential; it MUST be set to the URI of the Credential Endpoint of the Credential Issuer",
            "example": "http://it-wallet-provider.example.it/credential"
        },
        "sub": {
            "type": "string",
            "description": "The Subject of the Verifiable Credential",
            "example": "NzbLsXh8uDCcd7noWXFZAfHkxZsRGC9Xs"
        },
        "iat": {
            "type": "number",
            "description": "The UNIX Timestamp at which the Verifiable Credential was issued; can be used to determine age of the Verifiable Credential",
            "example": "1710346343"
        },
        "exp": {
            "type": "number",
            "description": "The UNIX Timestamp after which the Verifiable Credential expire",
            "example": "1701960844"
        },
        "nbf": {
            "type": "number",
            "description": "The UNIX Timestamp before which the Verifiable Credential must not be accepted for validating",
            "example": "1710346343"
        },
        "vct": {
            "type": "string",
            "description": "The type of the Verifiable Credential",
            "example": "PersonIdentificationData"
        },
        "_sd_alg": {
            "type": "string",
            "description": "The hash algorithm used for embedded the Disclosures into the Verifiable Credential payload. The resulting digest of a Discloser is included into the Verifiable Credential payload. Digest MUST be taken over the base64url-encoded Disclosure",
            "example": "sha-256"
        },
        "_sd": {
            "type": "array",
            "description": "Array of string representing selective disclosures of the claims about the Subject into the Verifiable Credential",
            "example": "[\"09vKrJMOlyTWM0sjpu_pdOBVBQ2M1y3KhpH515nXkpY\",\"2rsjGbaC0ky8mT0pJrPioWTq0_daw1sX76poUlgCwbI\",\"EkO8dhW0dHEJbvUHlE_VCeuC9uRELOieLZhh7XbUTtA\",\"IlDzIKeiZdDwpqpK6ZfbyphFvz5FgnWa-sN6wqQXCiw\",\"JzYjH4svliH0R3PyEMfeZu6Jt69u5qehZo7F7EPYlSE\",\"PorFbpKuVu6xymJagvkFsFXAbRoc2JGlAUA2BA4o7cI\",\"TGf4oLbgwd5JQaHyKVQZU9UdGE0w5rtDsrZzfUaomLo\",\"jdrTE8YcbY4EifugihiAe_BPekxJQZICeiUQwY9QqxI\",\"jsu9yVulwQQlhFlM_3JlzMaSFzglhQG0DpfayQwLUK4\"]",
            "items": {
              "type": "string",
              "description": "The base64url encoded SHA-256 thumbprint of a Disclosure presente inside the Verifiable Credential",
              "example": "MjQ5MTRhNWQ3YWU2YTZhZmIwZTY4ZTg0ZDJiZDNlYmMxYjliMzgxNQ"
            }
        },
        "cnf": {
            "type": "object",
            "description": "JSON object containing the public key (in JWK format) to which the Verifiable Credential is bound",
            "required": [
                "jwk"
            ],
            "properties": {
                "jwk": {
                    "type": "object",
                    "description": "JSON object representing the public key (in JWK format) to which the Verifiable Credential is bound",
                    "required": [
                        "crv",
                        "kyt",
                        "x",
                        "y"
                    ],
                    "properties": {
                        "crv": {
                            "type": "string",
                            "description": "The cryptographic curve used with the key. Values defined by this specification are 'P-256', 'P-384' and 'P-521'",
                            "example": "P-256"
                        },
                        "kty": {
                            "type": "string",
                            "description": "The cryptographic algorithm family used with the key, such as 'RSA' or 'EC'",
                            "example": "EC"
                        },
                        "x": {
                            "type": "string",
                            "description": "The x coordinate for the elliptic curve point. It is represented as the base64url encoding of the coordinate's big endian representation",
                            "example": "4HNptI-xr2pjyRJKGMnz4WmdnQD_uJSq4R95Nj98b44"
                        },
                        "y": {
                            "type": "string",
                            "description": "The y coordinate for the elliptic curve point. It is represented as the base64url encoding of the coordinate's big endian representation",
                            "example": "LIZnSB39vFJhYgS3k7jXE4r3-CoGFQwZtPBIRqpNlrg"
                        }
                    }
                }
            }
        }
    }
}