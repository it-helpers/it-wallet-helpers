{
    "$id": "https://example.com/wte_proof.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "Credential Proof of Possession",
    "type": "object",
    "required": [
        "jti",
        "iss",
        "iat",
        "exp",
        "credential_hash",
        "credential_hash_alg",
        "cnf"
    ],
    "properties": {
        "iss": {
            "type": "string",
            "description": "It MUST be set to the identifier of the Issuer",
            "example": "$base64url-encoded-thumprint-of-the-jwk-in-the-cnf-wallet-attestation$"
        },
        "iat": {
            "type": "number",
            "description": "The UNIX Timestamp at which the JWT was issued; can be used to determine age of the JWT",
            "example": "1710346343"
        },
        "exp": {
            "type": "number",
            "description": "The UNIX Timestamp after which the JWT expire",
            "example": "1701960844"
        },
        "credential_hash": {
            "type": "string",
            "description": "Contain the hash value of a Digital Credential, derived by computing the base64url encoded hash of the Digital Credential.",
            "example": "211f80400edeaaf683ba650e82b9ace246d3437278b01e73b77939b1ca6cc80d"
        },
        "credential_hash_alg": {
            "type": "string",
            "description": "Contain the Algorithm used for hashing the Digital Credential",
            "example": "S256"
        },
        "cnf": {
            "type": "object",
            "description": "containing the proof-of-possession key materials.",
            "required": [
                "jwk"
            ],
            "properties": {
                "jwk": {
                    "type": "object",
                    "description": "MUST match with the one provided within the related Credential.",
                    "required": [
                        "crv",
                        "kyt",
                        "x",
                        "y"
                    ],
                    "properties": {
                        "crv": {
                            "type": "string",
                            "description": "The cryptographic curve used with the key. Values defined by this specification are 'P-256', 'P-384' and 'P-521'",
                            "example": "P-256"
                        },
                        "kty": {
                            "type": "string",
                            "description": "The cryptographic algorithm family used with the key, such as 'RSA' or 'EC'",
                            "example": "EC"
                        },
                        "x": {
                            "type": "string",
                            "description": "The x coordinate for the elliptic curve point. It is represented as the base64url encoding of the coordinate's big endian representation",
                            "example": "4HNptI-xr2pjyRJKGMnz4WmdnQD_uJSq4R95Nj98b44"
                        },
                        "y": {
                            "type": "string",
                            "description": "The y coordinate for the elliptic curve point. It is represented as the base64url encoding of the coordinate's big endian representation",
                            "example": "LIZnSB39vFJhYgS3k7jXE4r3-CoGFQwZtPBIRqpNlrg"
                        }
                    }
                }
            }
        }
    }
}