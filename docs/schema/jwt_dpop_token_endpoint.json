{
    "$id": "https://example.com/jwt_dpop_token_endpoint.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "dpop token endpoint",
    "type": "string",
    "contentMediaType": "application/jwt",
    "contentSchema": 
    {
        "type": "array",
        "minItems": 2,
        "prefixItems":[
        {
            "const": {
                "typ": "dpop+jwt",
                "alg": "ES256",
                "jwk": "$public-key-in-jwk-format-of-the-private-key-used-by-the-issuer-to-sign-the-jwt$" 
            }
        },
        {
            "type": "object",
            "required": ["jti", "iat", "aud", "htu", "htm"],
            "properties": {
                "jti": {
                    "type": "string",
                    "description": "Unique identifier; can be used to prevent the JWT from being replayed (allows a token to be used only once)",
                    "format": "UUID",
                    "example": "e1j3V_bKic8-LAEA"
                },
                "iat": {
                    "type": "number",
                    "description": "The UNIX Timestamp at which the JWT was issued; can be used to determine age of the JWT",
                    "example": "1562262616"
                },
                "exp": {
                    "type": "number",
                    "description": "The UNIX Timestamp after which the JWT expire",
                    "example": "1562265687"
                },
                "htu": {
                    "type": "string",
                    "description": "The HTTP target URI of the request to which the JWT is attached, without query and fragment parts",
                    "example": "https://it-wallet-eid-provider.example.it/"
                },
                "htm": {
                    "type": "string",
                    "description": "The value of the HTTP method to which the JWT is attached",
                    "example": "POST"
                }
            }
        }
        ]
    }
}