{
    "$id": "https://example.com/dpop_credential_endpoint.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "dpop credential endpoint",
    "description": "The paylod of a DPoP proof JWT used as proof of possession of the sign private key corresponding the public key specified within his JWK header. Client sends the request for issuing a Verifiable Credential to the credential endpoint of the credential issuer and includes in header the DPoP proof JWT and the access token bounded to the public key of the DPoP proof JWT. The credential issuer validates access token by verifying that the public key of the DPoP proof JWT in the DPoP header matches the public key that the access token is bound to. When validation is successful",
    "type": "object",
    "required": [
        "jti",
        "iat",
        "aud",
        "htu",
        "htm",
        "ath"
    ],
    "properties": {
        "jti": {
            "type": "string",
            "description": "Unique identifier; can be used to prevent the JWT from being replayed (allows a token to be used only once)",
            "format": "UUID",
            "example": "e1j3V_bKic8-LAEB"
        },
        "iat": {
            "type": "number",
            "description": "The UNIX Timestamp at which the JWT was issued; can be used to determine age of the JWT",
            "example": "1710346343"
        },
        "htu": {
            "type": "string",
            "description": "The HTTP target URI of the request to which the JWT is attached, without query and fragment parts",
            "example": "https://it-wallet-eid-provider.example.it/credential"
        },
        "htm": {
            "type": "string",
            "description": "The value of the HTTP method to which the JWT is attached",
            "example": "POST"
        },
        "ath": {
            "type": "string",
            "description": "base64url encoded thumprint of the ASCII encoding of the associated access token's values",
            "example": "fUHyO2r2Z3DZ53EsNrWBb0xWXoaNy59IiKCAqksmQEo"
        }
    }
}